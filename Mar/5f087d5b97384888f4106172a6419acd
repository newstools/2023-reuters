DUBAI/RIYADH, March 10 (Reuters) - Iran and Saudi Arabia agreed on Friday to re-establish relations after years of hostility which had threatened stability and security in the Gulf and helped fuel conflicts in the Middle East from Yemen to Syria. The deal was announced after four days of previously undisclosed talks in Beijing between top security officials from the two rival Middle East powers. Tehran and Riyadh agreed to resume diplomatic relations and re-open embassies within two months, according to a statement issued by Iran, Saudi Arabia and China. "The agreement includes their affirmation of the respect for the sovereignty of states and the non-interference in internal affairs," it said. Saudi Arabia cut ties with Iran in 2016 after its embassy in Tehran was stormed during a dispute between the two countries over Riyadh's execution of a Shi'ite Muslim cleric. In recent years Saudi Arabia has blamed Iran for missile and drone attacks on the kingdom’s oil facilities in 2019 as well as attacks on tankers in Gulf waters. Iran denied the charges. Yemen’s Iran-aligned Houthi movement has also carried out cross-border missile and drone attacks into Saudi Arabia, which leads a coalition fighting the Houthis, and in 2022 extended the strikes to the UAE. Friday's agreement, signed by Iran's top security official, Ali Shamkhani, and Saudi Arabia's national security adviser Musaed bin Mohammed Al-Aiban, agreed to re-activate a 2001 security cooperation accord, as well as another earlier pact on trade, economy and investment. China's top diplomat Wang Yi described the deal as a victory for dialogue and peace, adding that Beijing would continue to play a constructive role in addressing tough global issues. A White House national security spokesperson said Saudi Arabia, which is looking to expand its partnership with China, had kept the United States informed about the talks in Beijing but that Washington had not been directly involved. Long-standing strategic ties between Saudi Arabia and the United States have been strained under President Joe Biden's administration over the kingdom's human rights record, the Yemen war and more recently ties with Russia and OPEC+ oil production. In contrast, Saudi Arabia's growing ties with China were highlighted by the high profile visit of President Xi Jinping three months ago. Iran and Saudi Arabia, respectively the two leading Shi'ite and Sunni Muslim powers in the Middle East, have been at odds for years and backed opposite sides in proxy wars from Yemen to Syria and elsewhere. Analysts say both sides stand to benefit from de-escalation, as Iran seeks to undercut U.S. efforts to isolate it in the region and Saudi Arabia tries to focus on economic development. "Further regional instability is not in Saudi or Iranian interest at the moment," said Kristian Coates Ulrichsen, a political scientist at Rice University's Baker Institute in the United States. "And for the Chinese to have addressed this at a time when the U.S. stance toward Iran is becoming more hawkish sends a powerful signal in itself." Saudi foreign minister Prince Faisal bin Farhan Al Saud, in remarks carried by state television, said Riyadh "favoured political solutions and dialogue" and was keen to entrench that in the region. Iranian Foreign Minister Hossein Amirabdollahian hinted at further steps to come. "The neighbourhood policy, as the key axis of the Iranian government’s foreign policy, is strongly moving in the right direction and the diplomatic apparatus is actively behind the preparation of more regional steps," Amirabdollahian tweeted. A senior Iranian official said that addressing the tensions with Saudi Arabia had become a top priority for Tehran in recent months and would help resolve long-running talks on Iran's nuclear programme. "It will encourage the West to reach a nuclear agreement with Iran," the official told Reuters. Saudi Arabia and its allies have long pressed global powers to address their fears about Iran's missile and drone programmes in their efforts to revive a 2015 nuclear agreement with Tehran. Cinzia Bianco, research fellow at the European Council on Foreign Relations, said Riyadh had been seeking security guarantees from the Iranians, which may have been addressed by the re-activation of the 2001 security accord. Iran may also have responded positively to Riyadh's calls for it to "actively push the Houthis to sign a peace agreement with Saudi Arabia that frees the Saudis from the Yemen war which has become a quagmire", Bianco said. "If those two (issues) are in place I am confident and positive about the deal." Prince Faisal, the Saudi foreign minister, said in January that progress was being made towards ending the Yemen conflict, and on Friday the Houthis in Yemen and Iran-allied Hezbollah in Lebanon welcomed the agreement. Oman's Foreign Minister Badr Albusaidi said on Twitter that the resumption of Saudi-Iranian diplomatic ties was a "win-win for everyone and will benefit regional and global security". Oman and Iraq hosted talks between Iran and Saudi Arabia in 2021 and 2022. Our Standards: The Thomson Reuters Trust Principles.